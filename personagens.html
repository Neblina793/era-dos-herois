<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Personagens - Era dos Heróis</title>
  <style>
    :root {
      --bg-body: #0b0b0f;
      --bg-card: #16161e;
      --gold: #d4af37;
      --primary-color: #e63946;
      --text-main: #eee;
      --border-color: #333;
    }

    body {
      font-family: 'Segoe UI', sans-serif;
      background: var(--bg-body);
      color: var(--text-main);
      margin: 0;
      padding: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
    }

    .container { width: 100%; max-width: 800px; }

    header { text-align: center; margin-bottom: 20px; width: 100%; }
    header img { max-width: 150px; }

    nav { display: flex; justify-content: center; gap: 10px; margin-bottom: 30px; }
    nav a { 
      border: 1px solid var(--gold); color: var(--gold); 
      padding: 8px 14px; text-decoration: none; transition: 0.3s;
    }
    nav a:hover { background: var(--gold); color: #000; }

    h2 { color: var(--gold); text-align: center; border-bottom: 1px solid var(--border-color); padding-bottom: 10px; }

    /* Estilo da Lista */
    .lista-nomes { list-style: none; padding: 0; }
    .item-personagem {
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      margin-bottom: 8px;
      padding: 15px;
      border-radius: 4px;
      cursor: pointer;
      transition: 0.2s;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .item-personagem:hover { border-color: var(--gold); background: #1f1f2a; }
    .item-personagem strong { color: var(--gold); font-size: 1.1em; }

    /* Ficha Detalhada (Escondida por padrão) */
    #detalhesFicha {
      display: none;
      background: var(--bg-card);
      border: 2px solid var(--gold);
      padding: 25px;
      border-radius: 8px;
      margin-top: 20px;
      position: relative;
    }

    .btn-fechar {
      position: absolute;
      top: 10px;
      right: 10px;
      background: var(--primary-color);
      color: white;
      border: none;
      padding: 5px 12px;
      cursor: pointer;
      border-radius: 4px;
    }

    /* Layout da Ficha */
    .ficha-header { border-bottom: 1px solid var(--gold); margin-bottom: 15px; padding-bottom: 10px; }
    .grid-stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin: 15px 0; }
    .stat-box { background: #000; padding: 10px; text-align: center; border-radius: 4px; border: 1px solid #333; }
    .stat-box small { color: var(--gold); display: block; font-size: 0.7em; }
    .stat-box b { font-size: 1.2em; }

    .secao-texto { background: #111; padding: 10px; border-radius: 4px; margin-top: 10px; }
    .secao-texto strong { color: var(--gold); display: block; margin-bottom: 5px; }
    
    .vazio { text-align: center; color: #666; margin-top: 40px; }
  </style>
</head>
<body>

<div class="container">
  <header>
    <img src="icon-192.png" alt="Logo">
    <h1 style="color: var(--gold);">Era dos Heróis</h1>
  </header>

  <nav>
    <a href="index.html">Início</a>
    <a href="criar.html">Criar Personagem</a>
    <a href="personagens.html">Personagens</a>
  </nav>

  <div id="areaLista">
    <h2>Meus Personagens</h2>
    <ul id="listaNomes" class="lista-nomes"></ul>
  </div>

  <div id="detalhesFicha">
    <button class="btn-fechar" onclick="fecharFicha()">X Fechar</button>
    <div id="conteudoFicha"></div>
  </div>
</div>

<script>
  const STORAGE_KEY = 'rpg_sheets_v3';
  let fichas = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];

  function renderizarLista() {
    const lista = document.getElementById('listaNomes');
    lista.innerHTML = '';

    if (fichas.length === 0) {
      lista.innerHTML = '<p class="vazio">Nenhum personagem encontrado. Vá em "Criar Personagem"!</p>';
      return;
    }

    fichas.forEach((p, index) => {
      const li = document.createElement('li');
      li.className = 'item-personagem';
      li.innerHTML = `
        <div>
          <strong>${p.nome}</strong><br>
          <small style="color:#888">${p.raca} ${p.classe} - Nível ${p.nivel}</small>
        </div>
        <span style="color:var(--gold)">Ver Ficha →</span>
      `;
      li.onclick = () => verFicha(index);
      lista.appendChild(li);
    });
  }

  function verFicha(index) {
    const p = fichas[index];
    const areaLista = document.getElementById('areaLista');
    const areaFicha = document.getElementById('detalhesFicha');
    const conteudo = document.getElementById('conteudoFicha');

    // Cálculo de modificador simples
    const mod = (val) => {
      let v = parseInt(val) || 10;
      let m = Math.floor((v - 10) / 2);
      return m >= 0 ? '+' + m : m;
    };

    conteudo.innerHTML = `
      <div class="ficha-header">
        <h1 style="margin:0; color:var(--gold)">${p.nome}</h1>
        <span>${p.raca} ${p.classe} | Nível ${p.nivel}</span>
      </div>

      <div class="grid-stats" style="grid-template-columns: repeat(3, 1fr);">
        <div class="stat-box"><small>PV</small><b>${p.hp}</b></div>
        <div class="stat-box"><small>CA</small><b>${p.ca}</b></div>
        <div class="stat-box"><small>MOV</small><b>${p.speed}</b></div>
      </div>

      <div class="grid-stats" style="grid-template-columns: repeat(6, 1fr);">
        <div class="stat-box"><small>FOR</small>${p.stats.for}<br><sub style="color:var(--gold)">${mod(p.stats.for)}</sub></div>
        <div class="stat-box"><small>DES</small>${p.stats.des}<br><sub style="color:var(--gold)">${mod(p.stats.des)}</sub></div>
        <div class="stat-box"><small>CON</small>${p.stats.con}<br><sub style="color:var(--gold)">${mod(p.stats.con)}</sub></div>
        <div class="stat-box"><small>INT</small>${p.stats.int}<br><sub style="color:var(--gold)">${mod(p.stats.int)}</sub></div>
        <div class="stat-box"><small>SAB</small>${p.stats.sab}<br><sub style="color:var(--gold)">${mod(p.stats.sab)}</sub></div>
        <div class="stat-box"><small>CAR</small>${p.stats.car}<br><sub style="color:var(--gold)">${mod(p.stats.car)}</sub></div>
      </div>

      <div class="secao-texto">
        <strong>Habilidades e Talentos:</strong>
        <p style="white-space: pre-wrap; margin:0;">${p.habilidades || 'Nenhuma habilidade registrada.'}</p>
      </div>

      <div class="secao-texto">
        <strong>Livro de Magias:</strong>
        <p style="white-space: pre-wrap; margin:0;">${p.magias || 'Não possui magias.'}</p>
      </div>
    `;

    areaLista.style.display = 'none';
    areaFicha.style.display = 'block';
    window.scrollTo(0,0);
  }

  function fecharFicha() {
    document.getElementById('areaLista').style.display = 'block';
    document.getElementById('detalhesFicha').style.display = 'none';
  }

  renderizarLista();
</script>

</body>
</html>